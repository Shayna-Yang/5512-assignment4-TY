---
title: "Does the Big Mac Index accurately reflect the real cost of living changes in Taiwan?"
subtitle: "Assignment 4 ETC5512"
author: "Tzu-Hsuan, Yang (ID: 35461586)"
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  error = FALSE,
  message = FALSE,
  warning = FALSE
  ) 
```

::: panel-tabset
<!-- Task 1 Tab: Data and Documenting -->

## Data and Documenting

### Research Question

Does the Big Mac Index accurately reflect the real cost of living changes in Taiwan? Analyze between 2015 and 2025.

-   Is the Big Mac Index a reliable indicator of Taiwan’s actual exchange rate (NTD/USD)?

-   How does the Big Mac price in Taiwan correlate with official CPI changes?

-   Does the valuation of the Taiwan Dollar based on Big Mac PPP match with economic reality?

### Data Sources and Suitability

This blog post analyzes the relationship between the Big Mac Index, Taiwan's official exchange rate, and domestic consumer prices to assess whether perceived increases in the cost of living are reflected in economic indicators. I selected three publicly available datasets that together provide a view of currency valuation, domestic price levels, and purchasing power:

#### 1. Big Mac Data

-   **Source:** [The Economist (GitHub)](https://github.com/TheEconomist/big-mac-data?tab=readme-ov-file)
-   **Content:** Prices of Big Macs around the world, actual exchange rates, implied purchasing power parity (PPP), and percentage under-/overvaluation relative to the US dollar. This data is published biannually (January and July).
-   **Last Updated:** Feb, 2025
-   **Data Type:** Sample
-   **Suitability:**
    -   Provides a standardized, internationally comparable measure of purchasing power.
    -   The Big Mac Index offers a consumer-centered, intuitive proxy for real-world exchange rate discrepancies.
-   **Limitations:**
    -   Only includes a single consumer good (Big Mac), which may not be representative of the overall cost of living.
    -   Prices gathered from few of McDonald’s branches in each country, which may pose difference between urban and rural areas.
-   **License:** Creative Commons Attribution 4.0 International License (CC BY 4.0) - This license allows for use, sharing, and adaptation of the data generated by The Economist.
-   **Privacy/Ethics:** Aggregated data, minimizing privacy concerns. No direct identifiers.

#### 2. Taiwan Consumer Price Index (CPI) Data

-   **Source:** [Taiwan Directorate-General of Budget, Accounting and Statistics](https://eng.stat.gov.tw/)
-   **Content:** Monthly CPI data for Taiwan, representing national cost-of-living trends based on a fixed consumer basket (2016=100). Includes both index values and year-on-year percentage changes.
-   **Last Updated:** 2025 Q1 (Quarterly Update)
-   **Data Type:** Census
-   **Suitability:**
    -   Provides an authoritative measurement of domestic inflation trends.
    -   The CPI data reflects broader household consumption trends beyond food alone, useful for cross-validating signals from the Big Mac Index.
-   **Limitations:**
    -   The CPI is a lagging indicator and may not capture real-time consumer sentiment and may not reflect the experience of specific population groups.
-   **License:** Open Government Data License, version 1.0 (OGDL-Taiwan-1.0) - This license allows reproducing, adapting, compiling, publicly transmitting, or applying it on other methods, and as well as developing various products or services for the data and materials. [Links to statement](https://eng.stat.gov.tw/cp.aspx?n=2313)
-   **Privacy/Ethics:** Aggregated data, minimizing privacy concerns. No direct identifiers.

#### 3. NTD/USD Exchange Rate Data

-   **Source:** [Central Bank of the Republic of China (Taiwan)](https://www.cbc.gov.tw/en/mp-2.html)
-   **Content:** Selling exchange rate of New Taiwan Dollar (NTD) against US Dollar (USD), extracted for January and July each year between 2015 and 2025. The rates represent the official figures published by the Central Bank of Taiwan.
-   **Last Updated:** May, 2025 (Monthly Update)
-   **Data Type:** Official financial data
-   **Suitability:**
    -   Represents the actual market exchange rate used in international trade
    -   Serves as the benchmark “real-world” reference to evaluate the Big Mac Index's predictive alignment.
-   **Limitations:**
    -   Exchange rates may not always align with domestic purchasing experiences.
    -   The data reflects the official spot rate, which might not align with real-world consumer exchange rates that include fees, spreads, or intermediary costs.
-   **License:** Open Government Data License, version 1.0 (OGDL-Taiwan-1.0) - This license allows reproducing, adapting, compiling, publicly transmitting, or applying it on other methods, and as well as developing various products or services for the data and materials. [Links to statement](https://www.cbc.gov.tw/en/cp-958-40419-F8209-2.html)
-   **Privacy/Ethics:** Aggregated data, minimizing privacy concerns. No direct identifiers.

### Data Downloading and Wrangling

This section outlines the steps to download the datasets used analysis. All processing was done by R using packages.

#### 1. Big Mac Data

Download steps:

1.  Access the dataset via GitHub: [The Economist- Big Mac Data](https://github.com/TheEconomist/big-mac-data?tab=readme-ov-file)

2.  Download the `big-mac-full-index.csv` in the output-data folder and save it to the `raw_data` folder

3.  Load the dataset into project

```{r}
# Library package
library(tidyverse)
library(lubridate)
library(rvest)
```

```{r}
# read raw data
bigmac_data <- read.csv("raw_data/big-mac-full-index.csv")

# filter for Taiwan from 2015 to 2025
bigmac_tw <- bigmac_data |>
  filter(name == "Taiwan") |>
  mutate(date = as.Date(date),
         year = year(date),
         month = month(date)) |>
  filter(year >= 2015 & year <= 2025) |>
  mutate(
    USD_valuation = (dollar_ex - USD_raw) / USD_raw 
    # for compare ppp and actual rate
  ) |>
  select(year, month, local_price, dollar_ex, USD_raw, USD_valuation)

# save processed data
write_csv(bigmac_tw, "data/bigmac_tw_2015-2025.csv")
```

#### 2. Taiwan Consumer Price Index (CPI) Data

Download steps:

1.  Access to [Taiwan DGBAS official site](https://eng.stat.gov.tw/) and click the `Data Query` banner to [DGBAS Statistical Database](https://eng.stat.gov.tw/cl.aspx?n=4015)

2.  Open the [Macro Database](https://nstatdb.dgbas.gov.tw/dgbasall/webMain.aspx?k=engmain) and choose: `Price Index` -\> `Consumer Price Index` -\> `1.1 Comsumer Price Indices by Basic Group`

3.  Set the filter condition:

-   Period: 2015-01\~2025-01 (To match the lastest update of big mac index data)
-   Frequency: Monthly
-   Value Types: Value and Annual Change Rate
-   Output: CSV
-   Statistical Items: General Index

4.  Submit and download the dataset then save it to the `raw_data` folder

5.  Load the dataset into project

```{r}
# read raw data
raw_cpi <- read_csv("raw_data/Monthly_CPI_2015-2025.csv", skip = 2)

# filter data from Jan 2015 to Jan 2025
cpi_processed <- raw_cpi |>
  rename(
    period = `Period`,
    CPI_index = `General Index`,
    YoY_rate = `Annual Change Rate(%)`
  ) |>
  # filter only the year-month in dataset
  filter(str_detect(period, "^\\d{4} [A-Za-z]{3}$")) |>
  mutate(
    period = parse_date_time(period, orders = "Y b"),
    year = year(period),
    month = month(period)
  ) |>
  filter(month %in% c(1, 7)) |>
  select(year, month, CPI_index, YoY_rate)

# save processed data
write_csv(cpi_processed, "data/tw_cpi_2015-2025.csv")
```

#### 3. NTD/USD Exchange Rate Data

Download steps:

1. Access to [Central Bank of the Republic of China (Taiwan)](https://www.cbc.gov.tw/en/mp-2.html) and go to: `Foreign Exchange` -> `Foreign Exchange Regime`

2. Click into the `Monthly` and `Monthly_Historical` and get the url link.

3. Load the dataset into project

```{r}
# define url
url_monthly <- "https://www.cbc.gov.tw/en/cp-480-58819-C8475-2.html"
url_historical <- "https://www.cbc.gov.tw/en/cp-480-58820-D92DC-2.html"

# function to extract the table
scrape_exchange_rate <- function(url) {
  # read html page
  webpage <- read_html(url)
  
  # grab first table
  tbl <- webpage |>
    html_table(fill = TRUE) |>
    purrr::pluck(1)
  
  # columns name
  names(tbl) <- c("Period", "NTD_USD")
  
  # for year loop
  current_year <- NA
  
  # dataframe for store the cleaned data
  clean_data <- data.frame(
    year = integer(),
    month = integer(),
    NTD_USD = numeric(),
    stringsAsFactors = FALSE
  )
  
  for (i in 1:nrow(tbl)) {
    row <- tbl[i, ]
    period_str <- row$Period
    ntd_val <- as.numeric(row$NTD_USD)
    
    current_month <- NA
    
    # check the format
    if (str_detect(period_str, "^\\d{4}/\\s*1$")) {
      current_year <- as.integer(str_extract(period_str, "^\\d{4}"))
      current_month <- 1
    } else if (!is.na(current_year) && str_detect(period_str, "^\\d+$")) {
      current_month <- as.integer(period_str)
    } else {
      next
    }
    
    # keep only Jan. and Jul.
    if (current_month %in% c(1, 7)) {
      clean_data <- rbind(clean_data, data.frame(
        year = current_year,
        month = current_month,
        NTD_USD = ntd_val
      ))
    }
  }
  return(clean_data)
}

# apply to both url
exchange_historical <- scrape_exchange_rate(url_historical)
exchange_recent <- scrape_exchange_rate(url_monthly)

# combine two data
exchange_all <- bind_rows(exchange_historical, exchange_recent) |>
  arrange(year, month) |>
  filter(year >= 2015 & year <= 2025)

# save processed data
write_csv(exchange_all, "data/twd_usd_exchange_2015_2025.csv")
```

#### 4. Combine the datasets

For further analysis, use `left_join()` to combine all the processed datasets.
```{r}
bigmac_all <- bigmac_tw |>
  left_join(cpi_processed, by = c("year", "month")) |>
  left_join(exchange_all, by = c("year", "month"))

# save processed data
write_csv(bigmac_all, "data/bigmac_2015-2025.csv")
```

### Reference



### Remember

Please mention any additional files that you want the markers to review, eg. read me, meta data etc.

<!-- Task 2 Tab: Writing your blogpost -->

## Blog post

### What's in this section

Here is where you should write your blogpost! (Task 2)

### Blogpost Structure

There is no strict structure for you to follow. However, here is a skeleton structure you may find helpful.

1.  Title (is set at the top of this document)
2.  Motivation\
3.  Data\
4.  Analysis\
5.  Conclusions\
6.  References

<!-- Task 3 Tab: Behind the Scenes -  -->

## Behind the Scenes

### What's in this section

Here is where you should tell us about your reflection on your analysis (Task 3).

Again, these are the details about **your** perspective and the gritty details behind the scenes of your analysis.

## AI Ackownledgement

The [queries] I asked GPT:

1. How to transfer the date form from `2015 Jan` to `2015 & 1` for join the two dataset

2. How to exclude the footnote in dataset

:::
